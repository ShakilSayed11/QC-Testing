<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Quality and Error Checks for Credibility Interviewers - Developed By Shakil Sayed</title>
    <link rel="stylesheet" href="styles.css">
</head>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 0;
    background-color: #f4f4f4;
}

.header {
    text-align: center;
    padding: 20px;
    background-color: #333;
    color: white;
}

form {
    max-width: 800px;
    margin: 20px auto;
    background: white;
    padding: 20px;
    border-radius: 8px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
}

.form-group {
    margin-bottom: 15px;
}

label {
    display: inline-block;
    width: 150px;
}

input[type="text"], input[type="date"], select, textarea {
    width: calc(100% - 160px);
    box-sizing: border-box;
    padding: 8px;
    border: 1px solid #ccc;
    border-radius: 4px;
}

table {
    width: 100%;
    border-collapse: collapse;
    margin-bottom: 20px;
}

table, th, td {
    border: 1px solid black;
}

th, td {
    padding: 10px;
    text-align: left;
}

textarea {
    width: 100%;
    box-sizing: border-box;
}

select {
    width: 100%;
    box-sizing: border-box;
}

input[type="number"] {
    width: 100%;
    box-sizing: border-box;
}

button {
    display: block;
    width: 100%;
    padding: 10px;
    background-color: #4CAF50;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-size: 16px;
}

button:hover {
    background-color: #45a049;
}
</style>
<body>
    <div class="header">
        <h1>Quality and Error Checks for Credibility Interviewers</h1>
        <p>Developed By Shakil Sayed</p>
    </div>
    <form id="qcForm">
        <div class="form-group">
            <label for="interviewDate">Interview Date:</label>
            <input type="date" id="interviewDate" name="interviewDate" required>
        </div>
        <div class="form-group">
            <label for="qcDate">QC Date:</label>
            <input type="date" id="qcDate" name="qcDate" required>
        </div>
        <div class="form-group">
            <label for="qcOfficer">QC Officer:</label>
            <input type="text" id="qcOfficer" name="qcOfficer" required>
        </div>
        <div class="form-group">
            <label for="studentName">Student Name:</label>
            <input type="text" id="studentName" name="studentName" required>
        </div>
        <div class="form-group">
            <label for="studentID">Student ID:</label>
            <input type="text" id="studentID" name="studentID" required>
        </div>

        <table>
            <thead>
                <tr>
                    <th>Sr. No.</th>
                    <th>Task Timings</th>
                    <th>Description</th>
                    <th>QC Remark's (Good, Average, Poor)</th>
                    <th>QC Comment's</th>
                    <th>Score (0-10)</th>
                </tr>
            </thead>
            <tbody>
                <!-- The rows will be inserted here by JavaScript -->
            </tbody>
        </table>
        <div class="form-group">
            <label for="overallPerformance">Overall Performance:</label>
            <input type="text" id="overallPerformance" name="overallPerformance" readonly>
        </div>
        <button type="button" id="savePDF">Save as PDF</button>
    </form>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.4.0/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.13/jspdf.plugin.autotable.min.js"></script>
    <script src="script.js"></script>
  <script>
document.addEventListener('DOMContentLoaded', function() {
    const form = document.getElementById('qcForm');
    const tableBody = form.querySelector('tbody');
    const savePDFButton = document.getElementById('savePDF');
    const overallPerformanceInput = document.getElementById('overallPerformance');
    
    const tasks = [
        "Proper Recording is done with clear facial visibility",
        "Proper self-introduction",
        "Behaviour - (Respectful and polite in nature throughout the Interview)",
        "Student Verification done (Passport / Academics)",
        "Network/ background noise / availability of interviewer without pause",
        "All relevant questions covered (Visa Refusals / Prev Studies)",
        "All relevant questions covered (Country, University, and Course including countries and universities comparisons)",
        "All relevant questions covered (Post Study plans and future goals)",
        "All relevant questions covered (Finances)",
        "All relevant questions covered (English Comms)",
        "Sheets Filled accurately",
        "Assessment Done properly",
        "Updation (Tracker / Cas Shield / IQ / T-drive / SharePoint)",
        "Feedback shared with Student / Agent.",
        "Overall Performance of the Interviewer"
    ];

    tasks.forEach((task, index) => {
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${index + 1}</td>
            <td>During Interview</td>
            <td>${task}</td>
            <td>
                <select name="qcRemarks${index + 1}">
                    <option value="Good">Good</option>
                    <option value="Average">Average</option>
                    <option value="Poor">Poor</option>
                </select>
            </td>
            <td><textarea name="qcComments${index + 1}"></textarea></td>
            <td><input type="number" name="score${index + 1}" min="0" max="10" step="1" required></td>
        `;
        tableBody.appendChild(row);
    });

    form.addEventListener('input', function() {
        let totalScore = 0;
        let count = 0;
        form.querySelectorAll('input[type="number"]').forEach(input => {
            if (input.value !== "") {
                totalScore += parseInt(input.value);
                count++;
            }
        });
        overallPerformanceInput.value = count ? (totalScore / count).toFixed(2) : '';
    });

    savePDFButton.addEventListener('click', function() {
        const { jsPDF } = window.jspdf;
        const doc = new jsPDF();

        // Header
        const pageWidth = doc.internal.pageSize.getWidth();
        doc.setFillColor(200, 200, 255); // light blue background
        doc.rect(0, 0, pageWidth, 30, 'F');

        doc.setFontSize(18);
        doc.setFont('helvetica', 'bold');
        doc.setTextColor(0, 0, 128); // dark blue text
        doc.text('Quality and Error Checks for Credibility Interviewers', pageWidth / 2, 15, { align: 'center' });

        doc.setFontSize(14);
        doc.setFont('helvetica', 'normal');
        doc.setTextColor(0, 0, 0); // black text
        doc.text('Developed By Shakil Sayed', pageWidth / 2, 25, { align: 'center' });

        const interviewDate = form.interviewDate.value;
        const qcDate = form.qcDate.value;
        const qcOfficer = form.qcOfficer.value;
        const studentName = form.studentName.value;
        const studentID = form.studentID.value;
        const overallPerformance = overallPerformanceInput.value;

        const infoRows = [
            ['Interview Date:', interviewDate],
            ['QC Date:', qcDate],
            ['QC Officer:', qcOfficer],
            ['Student Name:', studentName],
            ['Student ID:', studentID]
        ];

        doc.autoTable({
            head: [['Assessment Log', 'Input']],
            body: infoRows,
            startY: 40
        });

        const rows = [];
        tasks.forEach((task, index) => {
            const qcRemarks = form[`qcRemarks${index + 1}`].value;
            const qcComments = form[`qcComments${index + 1}`].value;
            const score = form[`score${index + 1}`].value;
            rows.push([index + 1, 'During Interview', task, qcRemarks, qcComments, score]);
        });

        doc.autoTable({
            head: [['Sr. No.', 'Task Timings', 'Description', "QC Remark's", "QC Comment's", 'Score']],
            body: rows,
            startY: doc.lastAutoTable.finalY + 10
        });

        doc.text(`Overall Performance: ${overallPerformance}`, 10, doc.lastAutoTable.finalY + 20);

        doc.save('Interview_QC_Report.pdf');
    });
});
  </script>
</body>
</html>
